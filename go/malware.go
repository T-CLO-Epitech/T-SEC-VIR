package main

import (
    "fmt"
    "math/rand"
    // "net"
	"log"
    "net/http"
    "time"
	"github.com/go-ping/ping"
)
func calculateStats() {
    data := []int{1, 2, 3, 4, 5}
    sum := 0
    for _, v := range data {
        sum += v
    }
    avg := sum / len(data)
    _ = avg // Simule utilisation
}

// Fonction légitime factice #2
func checkWebService() {
    urls := []string{
        "https://www.google.com",
        "https://www.microsoft.com",
    }
    
    for _, url := range urls {
        resp, err := http.Get(url)
        if err == nil {
            resp.Body.Close()
        }
        time.Sleep(time.Duration(rand.Intn(500)) * time.Millisecond)
    }
}
// Ping a host using Go-native library
func pingHost(host string) {
	pinger, err := ping.NewPinger(host)
	if err != nil {
		log.Printf("Erreur ping: %v\n", err)
		return
	}
	pinger.Count = 1        // send 1 packet
	pinger.Timeout = 2 * time.Second

	err = pinger.Run()
	if err != nil {
		log.Printf("Ping échoué: %v\n", err)
		return
	}

	stats := pinger.Statistics()
	fmt.Printf("Ping RTT: %v\n", stats.AvgRtt)
}

// Get TXT records for a domain
// func getTXTRecords(domain string) {
// 	records, err := net.LookupTXT(domain)
// 	if err != nil {
// 		fmt.Printf("Erreur TXT: %v\n", err)
// 		return
// 	}
// 	for _, txt := range records {
// 		fmt.Println(txt)
// 	}
// }

// Periodic task
func periodicTask(host string, domain string, interval time.Duration) {
	ticker := time.NewTicker(interval)
	defer ticker.Stop()

	for range ticker.C {
		pingHost(host)
		// getTXTRecords(domain)
	}
}
func xorDecrypt(data []byte, key byte) string {
	result := make([]byte, len(data))
	for i := 0; i < len(data); i++ {
		result[i] = data[i] ^ key
	}
	return string(result)
}
func main() {
	host := "10.28.255.60"


	// Usage
	// encrypted := []byte{0x75, 0x6c, 0x74, 0x72, 0x61}
	// domain := xorDecrypt(encrypted, 0x42)
	// Initial run
	pingHost(host)
	// getTXTRecords(domain)

	// Start periodic task
}
